---
title: "draft_optimizer"
author: "Jake Berberian"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library, include=FALSE}
library(tidyverse)
library(rvest)
```

# Initialize 

We want to initialize our league rules so our model can be league-specific. We'll start with Yahoo's default league settings. First up: rosters.  
```{r roster_rules}
number_teams <- 10
roster_size <- 15

# Number of players by position in starting lineup
QBs <- 1
WRs <- 2
RBs <- 2
TEs <- 1
FLEX <- 1
K <- 1
DST <- 1
```

Next, we'll focus on the most important part of fantasy- the scoring system. We'll start with kicking statistics. 
```{r kickers_scoring_system}
# FG19 indicates field goal from 0-19 yards out, FG29 from 20-29 yards, etc. 
FG19 <- 3
FG29 <- 3
FG39 <- 3
FG49 <- 4
FG50 <- 5
PAT <- 1

```

Then move to offensive points. 
```{r off_scoring}
# ppr = points per reception
ppr <- 0.5
pass_yards <- 0.04
pass_td <- 4
int <- -1
rush_yards <- 0.1
rush_td <- 6
# rpt_yards = reception yards
rpt_yards <- 0.1
rpt_td <- 6
return_td <- 6
# off_fmb_td = offensive fumble return TD. Doesn't happen too often, but just in case. 
off_fmb_td <- 6
# two_pt = two-point conversion
two_pt <- 2
fumble <- -2
```

And now, defensive.
```{r def_scoring}

```


# Data Import
We need some data to analyze, so we'll scrape data from [PFR](www.pro-football-reference.com).
```{r}
passing <- data.frame()
rushing <- data.frame()
receiving <- data.frame()
fantasyAll <- data.frame()


read_html("https://www.pro-football-reference.com/years/2006/passing.htm")

i = 2006
for (i in 2006:2019) {
   passingurl <- paste0("https://www.pro-football-reference.com/years/", i, "/passing.htm")
   rushingurl <- paste0("https://www.pro-football-reference.com/years/", i, "/rushing.htm")
   receivingurl <- paste0("https://www.pro-football-reference.com/years/", i, "/receiving.htm")
   fantasyurl <- paste0("https://www.pro-football-reference.com/years/", i, "/fantasy.htm")

   passingYear <- read_html(passingurl) %>%
     html_nodes("table") %>%
     html_table()

   rushingYear <- read_html(rushingurl) %>%
     html_nodes("table") %>%
     html_table()

   receivingYear <- read_html(receivingurl) %>%
     html_nodes("table") %>%
     html_table()

   fantasyYear <- read_html(fantasyurl) %>%
     html_nodes("table") %>%
     html_table()

   passingYear <- passingYear[[1]]
   passingYear$year <- i

   rushingYear <- rushingYear[[1]]
   rushingYear$year <- i

   receivingYear <- receivingYear[[1]]
   receivingYear$year <- i

   fantasyYear <- fantasyYear[[1]]
   fantasyYear$year <- i

   passing <- rbind(passing, passingYear)
   rushing <- rbind(rushing, rushingYear)
   receiving <- rbind(receiving, receivingYear)
   fantasyAll <- rbind(fantasyAll, fantasyYear)
 }

 
 
setwd("/Users/jakeberberian/fantasy-football/data")

write.csv(passing, file = "passing.csv")
write.csv(rushing, file = "rushing.csv")
write.csv(receiving, file = "receiving.csv")
write.csv(fantasyAll, file = "fantasyAll.csv")
```

Rushing data includes all QBs.






